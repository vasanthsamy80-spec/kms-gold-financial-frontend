<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Interest Payment History</title>

  <style>
    body {
      font-family: Arial;
      background: #fff8e1;
      padding: 20px;
      text-align: center;
    }

    /* ðŸ”¥ Top Box */
    .top-box {
      width: 100%;
      background: #f4b400;
      padding: 12px 0;
      text-align: left;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    /* ðŸ”¥ Back Button Style */
    .back-btn {
      background: #2ca4bf;
      color: white;
      padding: 10px 18px;
      border-radius: 6px;
      text-decoration: none;
      font-size: 18px;
      margin-left: 20px;
      display: inline-block;
      font-weight: bold;
    }

    .back-btn:hover {
      background: #5a1f8a;
    }

    table {
      width: 90%;
      margin: 20px auto;
      border-collapse: collapse;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
    }

    th {
      background: #f4b400;
      color: #000;
    }
  </style>
</head>

<body>

  <!-- ðŸ”¥ TOP BACK BUTTON BOX -->
  <div class="top-box">
    <a href="dashboard.html" class="back-btn">â¬… Back to Dashboard</a>
  </div>

  <h2>ðŸ’µ Interest Payment History</h2>

  <div id="list">Loading...</div>

  <script>
  async function loadInterestHistory() {
    const userEmail = localStorage.getItem('userEmail');
    const token = localStorage.getItem('token');

    if (!userEmail || !token) {
      alert('Please login');
      window.location.href = 'index.html';
      return;
    }

    try {
      const res = await fetch(
        `http://localhost:3000/api/loans/interest-history/${encodeURIComponent(userEmail)}`,
        { headers: { "Authorization": "Bearer " + token } }
      );

      const data = await res.json();

      if (!Array.isArray(data) || data.length === 0) {
        document.getElementById('list').textContent = 'No interest payments found.';
        return;
      }

      let html = `
        <table>
          <tr>
            <th>Date</th>
            <th>Amount Paid (â‚¹)</th>
          </tr>
      `;

      data.forEach(p => {
        html += `
          <tr>
            <td>${new Date(p.paymentDate).toLocaleDateString()}</td>
            <td>â‚¹${Number(p.amountPaid).toFixed(2)}</td>
          </tr>`;
      });

      html += `</table>`;
      document.getElementById('list').innerHTML = html;

    } catch (err) {
      document.getElementById('list').textContent =
        'Error loading history: ' + err.message;
    }
  }

  loadInterestHistory();
  </script>

</body>
</html>
